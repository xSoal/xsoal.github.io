(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(t,e,a){t.exports=a(63)},27:function(t,e,a){},29:function(t,e,a){},51:function(t,e,a){},53:function(t,e,a){},55:function(t,e,a){},57:function(t,e,a){},59:function(t,e,a){},61:function(t,e,a){},63:function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),o=a(20),c=a.n(o),u=(a(27),a(3)),s=a(4),i=a(6),d=a(5),l=a(7),p=(a(29),a(21)),h=a.n(p),f=(a(51),function(t){function e(){var t;return Object(u.a)(this,e),(t=Object(i.a)(this,Object(d.a)(e).call(this))).onChange=function(e){t.setState({date:e}),t.props.onDayChoiceFromCalendar(e)},t.state={date:new Date},t}return Object(l.a)(e,t),Object(s.a)(e,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(h.a,{onChange:this.onChange,value:this.state.date}))}}]),e}(n.Component)),y=(a(53),function(t){function e(){var t;return Object(u.a)(this,e),(t=Object(i.a)(this,Object(d.a)(e).call(this))).onChangeNameHandler=function(e){var a=e.target.value,n=t.props.productObj;n.product_name=a,t.props.onRenewProduct(n)},t.onChangeCountHandler=function(e){var a=e.target.value,n=t.props.productObj;n.product_count=a,t.props.onRenewProduct(n)},t.onChangeProductStatusHandler=function(e){var a=e.target.checked?"1":"0",n=t.props.productObj;n.product_status=a,t.props.onRenewProduct(n)},t.onKeyDowHandler=function(e){13===e.keyCode&&""!==e.target.value&&t.props.onAddProduct()},t.inputNameRef=r.a.createRef(),t}return Object(l.a)(e,t),Object(s.a)(e,[{key:"componentDidMount",value:function(){this.props.isEnableFocus&&this.inputNameRef.current.focus()}},{key:"render",value:function(){var t=this.props.productObj,e="1"===t.product_status;return console.log(e,"stats"),r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"text",className:"product__name",value:t.product_name,onChange:this.onChangeNameHandler,onKeyDown:this.onKeyDowHandler,ref:this.inputNameRef}),r.a.createElement("input",{type:"number",min:"1",className:"product_count",value:t.product_count?t.product_count:"1",onChange:this.onChangeCountHandler,onKeyDown:this.onKeyDowHandler}),r.a.createElement("input",{type:"checkbox",className:"product_status",checked:e,onChange:this.onChangeProductStatusHandler}))}}]),e}(n.Component)),v=(a(55),function(t){function e(){var t,a;Object(u.a)(this,e);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(r)))).onAddProductHandler=function(){a.props.onAddProduct()},a}return Object(l.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{onClick:this.onAddProductHandler,className:"product__add button"},"+"))}}]),e}(n.Component)),m=(a(57),function(t){function e(){var t,a;Object(u.a)(this,e);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(r)))).onDeleteProduct=function(){a.props.onDeleteProduct(a.props.productId)},a}return Object(l.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{onClick:this.onDeleteProduct,className:"product__deleteButton button"},"x"))}}]),e}(n.Component)),D=(a(59),function(t){function e(){var t,a;Object(u.a)(this,e);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(r)))).onClickHandler=function(){a.props.isLastSave||a.props.onSave()},a}return Object(l.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:this.onClickHandler,className:(this.props.isLastSave?" isLastSave ":"")+"currentDay__save"},"Save"))}}]),e}(n.Component)),b=(a(61),function(t){function e(){var t,a;Object(u.a)(this,e);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(r)))).onRenewProduct=function(t){a.props.onRenewProduct(t)},a.onAddProduct=function(){a.props.onAddProduct()},a.onDeleteProduct=function(t){a.props.onDeleteProduct(t)},a}return Object(l.a)(e,t),Object(s.a)(e,[{key:"componentWillReceiveProps",value:function(t){}},{key:"renderProducts",value:function(){var t=this,e=!1,a=this.props.currentDayData.map(function(a,n){return n===t.props.currentDayData.length-1&&(e=!a.product_name),a.wasDeleted?"":r.a.createElement("div",{key:100*n,className:"currentProduct"},r.a.createElement(y,{key:a.product_id,productObj:a,onRenewProduct:t.onRenewProduct,isEnableFocus:e,onAddProduct:t.onAddProduct}),r.a.createElement(m,{onDeleteProduct:t.onDeleteProduct,productId:a.product_id}))});return a.push(r.a.createElement(v,{key:"1000",onAddProduct:this.onAddProduct})),a}},{key:"render",value:function(){return r.a.createElement("div",{className:"currentDay"},this.renderProducts(),r.a.createElement(D,{onSave:this.props.onSave,isLastSave:this.props.isLastSave}))}}]),e}(n.Component));function w(t){var e=t.getMonth();return t.getFullYear()+"-"+ ++e+"-"+t.getDate()}function O(t,e){var a=[];return t.forEach(function(t,n){t.indexInAllDataArray=n,t.day===e&&a.push(t)}),a}var g="portfolio",j={dev:{baseUrl:"http://api.tobuy.io/"},build:{baseUrl:"http://"+window.location.host+"/api/"}},P=function(t){function e(){var t,a;Object(u.a)(this,e);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(r)))).state={isLoad:!0,isLastSave:!0,data:[],currentDay:w(new Date),currentDayData:!1},a.onDayChoiceFromCalendar=function(t){var e=w(t),n=O(a.state.data,e);a.setState({currentDay:e,currentDayData:n})},a.renewData=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=O(t,a.state.currentDay);a.setState({data:t,currentDayData:r,isLastSave:e,isLoad:n})},a.onRenewProduct=function(t){var e=a.state.data,n=t.indexInAllDataArray;t.isEdited=!0,e[n]=t,a.renewData(e)},a.onAddProduct=function(){var t=a.state.data.length,e=a.state.data[t-1].product_id,n=a.state.data;n.push({day:a.state.currentDay,day_id:function(t,e){var a=!1;return e.forEach(function(e){e.day===t&&(a=e.day_id)}),a}(a.state.currentDay,a.state.data),product_id:"".concat(++e),product_count:1}),n=n.map(function(t){return t.wasDeletedAllDay=!1,t}),a.renewData(n)},a.onDeleteProduct=function(t){var e=null;a.state.data.forEach(function(a,n){a.product_id===t&&(e=n)});var n,r,o=a.state.data;o[e].wasDeleted=!0,n=o,r=a.state.currentDay,n.every(function(t){return t.day!==r||!!t.wasDeleted})&&(o[e].wasDeletedAllDay=!0),a.renewData(o)},a.onSave=function(){if("portfolio"!==g){var t=new FormData;t.append("save",JSON.stringify(a.state.data)),fetch(j[g].baseUrl,{method:"POST",body:t}).then(function(t){return t.text()}).then(function(t){console.log(JSON.parse(t),"NEW DATA"),a.renewData(JSON.parse(t),!0)})}else a.renewData(a.state.data,!0)},a}return Object(l.a)(e,t),Object(s.a)(e,[{key:"componentWillMount",value:function(){var t=this;if("portfolio"!==g){var e=new XMLHttpRequest;e.open("GET",j[g].baseUrl+"?getAllDays=&",!0),e.send(),e.onreadystatechange=function(){if(4!==e.readyState)return!1;if(200!==e.status);else{var a=O(JSON.parse(e.responseText),t.state.currentDay);t.setState({data:JSON.parse(e.responseText),currentDayData:a,isLoad:!1})}}}else{var a=JSON.parse('[{"day_id":"94","day":"2012-01-01","product_name":"test","product_count":"1","product_id":"127","product_status":"0"},{"day_id":"95","day":"2018-11-20","product_name":"test","product_count":"1","product_id":"128","product_status":"0"}]'),n=O(a,this.state.currentDay);this.setState({data:a,currentDayData:n,isLoad:!1})}}},{key:"componentDidMount",value:function(){var t=this;"portfolio"!==g&&setInterval(function(){if(t.state.isLastSave){t.setState({isLoad:!0});var e=new XMLHttpRequest;e.open("GET",j[g].baseUrl+"?getAllDays=&",!0),e.send(),e.onreadystatechange=function(){if(4!==e.readyState)return!1;if(200!==e.status);else{var a=JSON.parse(e.responseText);JSON.stringify(O(a,t.state.currentDay))!==JSON.stringify(O(t.state.data,t.state.currentDay))&&t.renewData(a,!0,!1)}}}},2500)}},{key:"render",value:function(){return r.a.createElement("div",{className:"wrapper"},"portfolio"===g?r.a.createElement("div",{className:"alertMessage"},"This mode 'for test and read only' , becouse this list is must work on local server with local dataBase at my home.",r.a.createElement("hr",null),"Also i don't need ui in this =) It's my easy react spa work's fine like as my order list, that works from many devices at one moment of time and push products for home without reload =)"):"",r.a.createElement("h1",{className:"header__h1 h1"},"To buy list"),this.state.isLoad?"Loading...":"Load",r.a.createElement("div",{className:"calendar"},r.a.createElement(f,{onDayChoiceFromCalendar:this.onDayChoiceFromCalendar})),this.state.currentDayData?r.a.createElement(b,{currentDayData:this.state.currentDayData,onRenewProduct:this.onRenewProduct,onAddProduct:this.onAddProduct,onDeleteProduct:this.onDeleteProduct,onSave:this.onSave,isLastSave:this.state.isLastSave}):"")}}]),e}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[22,2,1]]]);
//# sourceMappingURL=main.87813b1c.chunk.js.map